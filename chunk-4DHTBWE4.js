import{a as Y}from"./chunk-C2FYHONP.js";import{a as X}from"./chunk-NZLYIASJ.js";import{a as W,c as j,d as B,e as q,f as z,g as G,h as H,o as J,p as K,r as Q,s as U}from"./chunk-4J4J2DGP.js";import{$ as p,Ea as C,F as c,Fa as V,G as u,Ha as T,P as m,R as h,Ra as k,S as y,Sa as L,W as _,Wa as P,Xa as F,Ya as R,fb as O,ga as n,ha as i,hb as N,ia as M,ib as A,la as f,ma as g,na as l,rb as D,sa as a,ta as v,ua as b,va as E,wa as I,xa as x,ya as w}from"./chunk-57XHIBD7.js";import{a as S}from"./chunk-AIZVJUQQ.js";function $(o,t){if(o&1&&(n(0,"h4"),a(1),i()),o&2){let e=l();m(),v(e.restaurant.name)}}function ee(o,t){if(o&1){let e=f();n(0,"div",17),a(1),n(2,"button",18),g("click",function(){c(e);let r=l();return u(r.errorMessage="")}),i()()}if(o&2){let e=l();m(),b(" ",e.errorMessage," ")}}function te(o,t){if(o&1){let e=f();n(0,"div",19),a(1),n(2,"button",18),g("click",function(){c(e);let r=l();return u(r.successMessage="")}),i()()}if(o&2){let e=l();m(),b(" ",e.successMessage," ")}}function ne(o,t){if(o&1){let e=f();n(0,"div",20)(1,"div",21)(2,"h3"),a(3),i()(),n(4,"div",22)(5,"form",23),g("ngSubmit",function(){c(e);let r=l();return u(r.submitMenuItem())}),n(6,"div",24)(7,"label",25),a(8,"Name*"),i(),n(9,"input",26),w("ngModelChange",function(r){c(e);let d=l();return x(d.newMenuItem.name,r)||(d.newMenuItem.name=r),u(r)}),i()(),n(10,"div",24)(11,"label",27),a(12,"Description*"),i(),n(13,"textarea",28),w("ngModelChange",function(r){c(e);let d=l();return x(d.newMenuItem.description,r)||(d.newMenuItem.description=r),u(r)}),i()(),n(14,"div",24)(15,"label",29),a(16,"Price ($)*"),i(),n(17,"input",30),w("ngModelChange",function(r){c(e);let d=l();return x(d.newMenuItem.price,r)||(d.newMenuItem.price=r),u(r)}),i()(),n(18,"div",31)(19,"button",32),a(20,"Save"),i(),n(21,"button",33),g("click",function(){c(e);let r=l();return u(r.cancelForm())}),a(22,"Cancel"),i()()()()()}if(o&2){let e=l();m(3),b("",e.isEditMode?"Edit":"Add New"," Menu Item"),m(6),I("ngModel",e.newMenuItem.name),m(4),I("ngModel",e.newMenuItem.description),m(4),I("ngModel",e.newMenuItem.price)}}function ie(o,t){o&1&&(n(0,"div",34)(1,"div",35)(2,"span",36),a(3,"Loading..."),i()()())}function re(o,t){if(o&1){let e=f();n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),C(5,"slice"),i(),n(6,"td"),a(7),C(8,"currency"),i(),n(9,"td")(10,"div",40)(11,"button",41),g("click",function(){let r=c(e).$implicit,d=l(2);return u(d.editMenuItem(r))}),M(12,"i",42),a(13,"Edit "),i(),n(14,"button",43),g("click",function(){let r=c(e).$implicit,d=l(2);return u(d.deleteMenuItem(r.id||""))}),M(15,"i",44),a(16,"Delete "),i()()()()}if(o&2){let e=t.$implicit;m(2),v(e.name),m(2),E("",T(5,4,e.description,0,50),"",e.description.length>50?"...":"",""),m(3),v(V(8,8,e.price))}}function ae(o,t){if(o&1&&(n(0,"div",37)(1,"table",38)(2,"thead")(3,"tr")(4,"th"),a(5,"Name"),i(),n(6,"th"),a(7,"Description"),i(),n(8,"th"),a(9,"Price"),i(),n(10,"th"),a(11,"Actions"),i()()(),n(12,"tbody"),_(13,re,17,10,"tr",39),i()()()),o&2){let e=l();m(13),p("ngForOf",e.menuItems)}}function oe(o,t){o&1&&(n(0,"div",45),a(1,' No menu items found for this restaurant. Click the "Add Menu Item" button to create one. '),i())}var Z=class o{constructor(t,e,s,r,d){this.route=t;this.router=e;this.menuItemService=s;this.restaurantService=r;this.authService=d}restaurant=null;menuItems=[];isLoading=!1;errorMessage="";successMessage="";menuItemToEdit=null;isEditMode=!1;showForm=!1;newMenuItem={name:"",description:"",price:0,restaurantId:""};ngOnInit(){if(!this.authService.isLoggedIn||!this.authService.isAdmin){this.router.navigate(["/"]);return}let t=this.route.snapshot.paramMap.get("id");if(!t){this.errorMessage="No restaurant ID provided";return}this.loadRestaurant(t),this.loadMenuItems(t)}loadRestaurant(t){this.isLoading=!0,this.restaurantService.getById(t).subscribe({next:e=>{this.restaurant=e,this.isLoading=!1},error:e=>{this.handleError(e)}})}loadMenuItems(t){this.isLoading=!0,this.menuItemService.getByRestaurant(t).subscribe({next:e=>{this.menuItems=e,this.isLoading=!1},error:e=>{this.handleError(e)}})}createMenuItem(){this.restaurant?.id&&(this.isEditMode=!1,this.menuItemToEdit=null,this.newMenuItem={name:"",description:"",price:0,restaurantId:this.restaurant.id},this.showForm=!0)}editMenuItem(t){this.isEditMode=!0,this.menuItemToEdit=t,this.newMenuItem=S({},t),this.showForm=!0}cancelForm(){this.showForm=!1,this.menuItemToEdit=null,this.errorMessage="",this.successMessage=""}submitMenuItem(){this.validateForm()&&(this.isLoading=!0,this.errorMessage="",this.successMessage="",this.isEditMode&&this.menuItemToEdit?.id?this.menuItemService.update(this.menuItemToEdit.id,this.newMenuItem).subscribe({next:()=>{this.handleSuccess("Menu item updated successfully")},error:t=>{this.handleError(t)}}):this.menuItemService.create(this.newMenuItem).subscribe({next:()=>{this.handleSuccess("Menu item created successfully")},error:t=>{this.handleError(t)}}))}deleteMenuItem(t){confirm("Are you sure you want to delete this menu item? This cannot be undone.")&&(this.isLoading=!0,this.errorMessage="",this.menuItemService.delete(t).subscribe({next:()=>{this.handleSuccess("Menu item deleted successfully")},error:e=>{this.handleError(e)}}))}validateForm(){return!this.newMenuItem.name||this.newMenuItem.name.trim()===""?(this.errorMessage="Menu item name is required.",!1):!this.newMenuItem.description||this.newMenuItem.description.trim()===""?(this.errorMessage="Description is required.",!1):this.newMenuItem.price<=0?(this.errorMessage="Price must be greater than zero.",!1):!0}handleSuccess(t){this.isLoading=!1,this.successMessage=t,this.restaurant?.id&&this.loadMenuItems(this.restaurant.id),this.showForm=!1}handleError(t){this.isLoading=!1,this.errorMessage=t.message||"An error occurred while processing your request."}static \u0275fac=function(e){return new(e||o)(h(O),h(N),h(Y),h(X),h(D))};static \u0275cmp=y({type:o,selectors:[["app-menu-management"]],decls:23,vars:7,consts:[[1,"container","py-4"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[4,"ngIf"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-plus-circle","me-2"],["class","alert alert-danger alert-dismissible fade show","role","alert",4,"ngIf"],["class","alert alert-success alert-dismissible fade show","role","alert",4,"ngIf"],["class","card mb-4",4,"ngIf"],["class","d-flex justify-content-center",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","alert alert-info",4,"ngIf"],[1,"mt-4","mb-5"],["routerLink","/admin/restaurant-management",1,"btn","btn-secondary","me-2"],[1,"bi","bi-arrow-left","me-2"],["routerLink","/admin",1,"btn","btn-outline-secondary"],[1,"bi","bi-speedometer2","me-2"],[1,"mb-5","pb-5"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],["type","button",1,"btn-close",3,"click"],["role","alert",1,"alert","alert-success","alert-dismissible","fade","show"],[1,"card","mb-4"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","id","name","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","description",1,"form-label"],["id","description","name","description","rows","3","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","price",1,"form-label"],["type","number","id","price","name","price","min","0.01","step","0.01","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","gap-2"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"table-responsive"],[1,"table","table-striped","table-hover"],[4,"ngFor","ngForOf"],["role","group",1,"btn-group"],[1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"bi","bi-pencil","me-1"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"bi","bi-trash","me-1"],[1,"alert","alert-info"]],template:function(e,s){e&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h1"),a(4,"Menu Management"),i(),_(5,$,2,1,"h4",2),i(),n(6,"button",3),g("click",function(){return s.createMenuItem()}),M(7,"i",4),a(8,"Add Menu Item "),i()(),_(9,ee,3,1,"div",5)(10,te,3,1,"div",6)(11,ne,23,4,"div",7)(12,ie,4,0,"div",8)(13,ae,14,1,"div",9)(14,oe,2,0,"div",10),n(15,"div",11)(16,"a",12),M(17,"i",13),a(18,"Back to Restaurants "),i(),n(19,"a",14),M(20,"i",15),a(21,"Dashboard "),i()(),M(22,"div",16),i()),e&2&&(m(5),p("ngIf",s.restaurant),m(4),p("ngIf",s.errorMessage),m(),p("ngIf",s.successMessage),m(),p("ngIf",s.showForm),m(),p("ngIf",s.isLoading),m(),p("ngIf",!s.isLoading&&s.menuItems.length),m(),p("ngIf",!s.isLoading&&!s.menuItems.length))},dependencies:[R,k,L,F,P,Q,G,W,H,j,B,K,J,z,q,U,A],styles:[".table-responsive[_ngcontent-%COMP%]{overflow-x:auto}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:.25rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-right:0}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa}@media (max-width: 768px){.btn-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:0;margin-bottom:.25rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-bottom:0}}"]})};export{Z as MenuManagementComponent};
