import{a as j,b as U,c as q}from"./chunk-3GKHYPM2.js";import{r as $}from"./chunk-4J4J2DGP.js";import{$ as _,F as x,G as y,Ia as F,P as o,Qa as k,R as M,Ra as T,S as w,Sa as D,W as p,Ya as N,ga as n,ha as t,hb as V,ia as b,ib as L,la as C,ma as O,na as u,ra as A,rb as H,sa as i,ta as h,ua as f}from"./chunk-57XHIBD7.js";import{a as S,b as E}from"./chunk-AIZVJUQQ.js";function z(a,r){if(a&1){let e=C();n(0,"div",12),i(1),n(2,"button",13),O("click",function(){x(e);let m=u();return y(m.errorMessage="")}),t()()}if(a&2){let e=u();o(),f(" ",e.errorMessage," ")}}function Y(a,r){if(a&1){let e=C();n(0,"div",14),i(1),n(2,"button",13),O("click",function(){x(e);let m=u();return y(m.successMessage="")}),t()()}if(a&2){let e=u();o(),f(" ",e.successMessage," ")}}function B(a,r){a&1&&(n(0,"div",15)(1,"div",16)(2,"span",17),i(3,"Loading..."),t()()())}function Q(a,r){a&1&&b(0,"span",30)}function G(a,r){if(a&1){let e=C();n(0,"div",18)(1,"div",19)(2,"div",20)(3,"h4",21),i(4,"Confirm Order Closure"),t(),n(5,"button",13),O("click",function(){x(e);let m=u();return y(m.cancelCloseOrder())}),t()(),n(6,"div",22)(7,"div",23),b(8,"i",24),i(9," Are you sure you want to close this order? "),t(),n(10,"p"),i(11,"This will finalize the order and prevent any further modifications."),t(),n(12,"div",25)(13,"p")(14,"strong"),i(15,"Order ID:"),t(),i(16),t(),n(17,"p")(18,"strong"),i(19,"Restaurant:"),t(),i(20),t(),n(21,"p")(22,"strong"),i(23,"Date:"),t(),i(24),t()()(),n(25,"div",26)(26,"button",27),O("click",function(){x(e);let m=u();return y(m.cancelCloseOrder())}),i(27,"Cancel"),t(),n(28,"button",28),O("click",function(){x(e);let m=u();return y(m.confirmCloseOrder())}),p(29,Q,1,0,"span",29),i(30," Close Order "),t()()()()}if(a&2){let e=u();o(16),f(" ",e.orderToClose.id,""),o(4),f(" ",(e.orderToClose.restaurant==null?null:e.orderToClose.restaurant.name)||"N/A",""),o(4),f(" ",e.formatDate(e.orderToClose.orderDate),""),o(4),_("disabled",e.isProcessingClose),o(),_("ngIf",e.isProcessingClose)}}function J(a,r){a&1&&(n(0,"div",36)(1,"div",16)(2,"span",17),i(3,"Loading details..."),t()()())}function K(a,r){if(a&1&&(n(0,"p")(1,"strong"),i(2,"Closed At:"),t(),i(3),t()),a&2){let e=u(3);o(3),f(" ",e.formatDate(e.selectedOrder.closedAt)," ")}}function X(a,r){if(a&1){let e=C();n(0,"button",62),O("click",function(){x(e);let m=u().$implicit,c=u(4);return y(c.updatePaymentStatus(c.selectedOrder.id,m,c.PaymentStatus.Paid))}),b(1,"i",63),i(2," Mark as Paid "),t()}if(a&2){let e=u(5);_("disabled",e.processingPayment)}}function Z(a,r){if(a&1){let e=C();n(0,"button",64),O("click",function(){x(e);let m=u().$implicit,c=u(4);return y(c.updatePaymentStatus(c.selectedOrder.id,m,c.PaymentStatus.Unpaid))}),b(1,"i",65),i(2," Mark as Unpaid "),t()}if(a&2){let e=u(5);_("disabled",e.processingPayment)}}function ee(a,r){if(a&1&&(n(0,"tr")(1,"td"),i(2),t(),n(3,"td"),i(4),t(),n(5,"td"),i(6),t(),n(7,"td"),i(8),t(),n(9,"td"),i(10),t()()),a&2){let e=r.$implicit;o(2),h((e.menuItem==null?null:e.menuItem.name)||"Unknown Item"),o(2),f("$",(e.menuItem==null||e.menuItem.price==null?null:e.menuItem.price.toFixed(2))||"0.00",""),o(2),h(e.quantity),o(2),f("$",(((e.menuItem==null?null:e.menuItem.price)||0)*e.quantity).toFixed(2),""),o(2),h(e.note||"-")}}function te(a,r){if(a&1&&(n(0,"tr",66)(1,"td",67),i(2,"Delivery Fee (per user):"),t(),n(3,"td"),i(4),t(),n(5,"td"),i(6,"-"),t()()),a&2){let e=u().$implicit,s=u(4);o(4),f("$",s.selectedOrder.userItems[e].deliveryFee.toFixed(2),"")}}function ne(a,r){if(a&1&&(n(0,"div",51)(1,"div",52)(2,"div",53)(3,"h4",45),i(4),t(),n(5,"div")(6,"span",54),i(7),t(),p(8,X,3,1,"button",55)(9,Z,3,1,"button",56),t()(),n(10,"div",46)(11,"div",57)(12,"table",58)(13,"thead")(14,"tr")(15,"th"),i(16,"Item"),t(),n(17,"th"),i(18,"Price"),t(),n(19,"th"),i(20,"Quantity"),t(),n(21,"th"),i(22,"Total"),t(),n(23,"th"),i(24,"Note"),t()()(),n(25,"tbody"),p(26,ee,11,5,"tr",59)(27,te,7,1,"tr",60),t(),n(28,"tfoot")(29,"tr")(30,"th",61),i(31,"Subtotal:"),t(),n(32,"th"),i(33),t(),b(34,"th"),t()()()()()()()),a&2){let e=r.$implicit,s=u(4);o(4),h(s.selectedOrder.userItems[e].userName),o(2),_("ngClass",s.selectedOrder.userItems[e].isPaid?"bg-success":"bg-danger"),o(),f(" ",s.selectedOrder.userItems[e].isPaid?"Paid":"Unpaid"," "),o(),_("ngIf",s.selectedOrder.status===s.OrderStatus.Closed&&!s.selectedOrder.userItems[e].isPaid),o(),_("ngIf",s.selectedOrder.status===s.OrderStatus.Closed&&s.selectedOrder.userItems[e].isPaid),o(17),_("ngForOf",s.selectedOrder.userItems[e].items),o(),_("ngIf",s.selectedOrder.userItems[e].deliveryFee>0),o(6),f("$",s.selectedOrder.userItems[e].totalAmount.toFixed(2),"")}}function re(a,r){if(a&1&&(n(0,"tr")(1,"th"),i(2,"Delivery Fee:"),t(),n(3,"td",49),i(4),t()()),a&2){let e=u(4);o(4),f("$",e.selectedOrder.deliveryFee.toFixed(2),"")}}function ie(a,r){if(a&1&&(n(0,"div"),p(1,ne,35,8,"div",42),n(2,"div",43)(3,"div",44)(4,"h4",45),i(5,"Order Summary"),t()(),n(6,"div",46)(7,"div",38)(8,"div",47)(9,"table",48)(10,"tbody")(11,"tr")(12,"th"),i(13,"Items Total:"),t(),n(14,"td",49),i(15),t()(),p(16,re,5,1,"tr",8),n(17,"tr",50)(18,"th"),i(19,"Total Amount:"),t(),n(20,"td",49),i(21),t()()()()()()()()()),a&2){let e=u(3);o(),_("ngForOf",e.Object.keys(e.selectedOrder.userItems)),o(14),f("$",(e.selectedOrder.totalAmount-(e.selectedOrder.deliveryFee||0)).toFixed(2),""),o(),_("ngIf",e.selectedOrder.deliveryFee),o(5),f("$",e.selectedOrder.totalAmount==null?null:e.selectedOrder.totalAmount.toFixed(2),"")}}function se(a,r){a&1&&(n(0,"div",68),i(1," No items found for this order. "),t())}function ae(a,r){if(a&1&&(n(0,"div")(1,"div",37)(2,"div",38)(3,"div",39)(4,"p")(5,"strong"),i(6,"Order ID:"),t(),i(7),t(),n(8,"p")(9,"strong"),i(10,"Restaurant:"),t(),i(11),t()(),n(12,"div",39)(13,"p")(14,"strong"),i(15,"Date:"),t(),i(16),t(),p(17,K,4,1,"p",8),t()()(),n(18,"h3",40),i(19,"Order Items by User"),t(),p(20,ie,22,4,"div",41)(21,se,2,0,"ng-template",null,0,F),t()),a&2){let e=A(22),s=u(2);o(7),f(" ",s.selectedOrder.id,""),o(4),f(" ",(s.selectedOrder.restaurant==null?null:s.selectedOrder.restaurant.name)||"N/A",""),o(5),f(" ",s.formatDate(s.selectedOrder.orderDate),""),o(),_("ngIf",s.selectedOrder.status===s.OrderStatus.Closed),o(3),_("ngIf",s.selectedOrder.userItems&&s.Object.keys(s.selectedOrder.userItems).length>0)("ngIfElse",e)}}function de(a,r){if(a&1){let e=C();n(0,"button",69),O("click",function(){x(e);let m=u(2);return y(m.showCloseOrderConfirmation(m.selectedOrder))}),i(1," Close Order "),t()}}function oe(a,r){if(a&1){let e=C();n(0,"div",31)(1,"div",32)(2,"div",20)(3,"h2",21),i(4," Order Details "),n(5,"span",33),i(6),t()(),n(7,"button",13),O("click",function(){x(e);let m=u();return y(m.clearSelectedOrder())}),t()(),n(8,"div",22),p(9,J,4,0,"div",34)(10,ae,23,6,"div",8),t(),n(11,"div",26)(12,"button",27),O("click",function(){x(e);let m=u();return y(m.clearSelectedOrder())}),i(13,"Close"),t(),p(14,de,2,0,"button",35),t()()()}if(a&2){let e=u();o(5),_("ngClass",e.getOrderStatusClass(e.selectedOrder.status)),o(),f(" ",e.getOrderStatusName(e.selectedOrder.status)," "),o(3),_("ngIf",e.isLoadingDetails),o(),_("ngIf",!e.isLoadingDetails),o(4),_("ngIf",e.selectedOrder.status===e.OrderStatus.Open)}}function le(a,r){a&1&&(n(0,"div",68),i(1," No active orders found. "),t())}function me(a,r){if(a&1){let e=C();n(0,"tr")(1,"td"),i(2),t(),n(3,"td"),i(4),t(),n(5,"td"),i(6),t(),n(7,"td"),i(8),t(),n(9,"td")(10,"div",76)(11,"button",77),O("click",function(){let m=x(e).$implicit,c=u(3);return y(c.viewOrderDetails(m))}),b(12,"i",78),i(13," View Details "),t(),n(14,"button",79),O("click",function(){let m=x(e).$implicit,c=u(3);return y(c.showCloseOrderConfirmation(m))}),b(15,"i",80),i(16," Close Order "),t()()()()}if(a&2){let e=r.$implicit,s=u(3);o(2),h(e.id),o(2),h((e.restaurant==null?null:e.restaurant.name)||"N/A"),o(2),h(s.formatDate(e.orderDate)),o(2),h(e.managerName||"N/A")}}function ce(a,r){if(a&1&&(n(0,"div",57)(1,"table",75)(2,"thead")(3,"tr")(4,"th"),i(5,"Order ID"),t(),n(6,"th"),i(7,"Restaurant"),t(),n(8,"th"),i(9,"Date"),t(),n(10,"th"),i(11,"Manager"),t(),n(12,"th"),i(13,"Actions"),t()()(),n(14,"tbody"),p(15,me,17,4,"tr",59),t()()()),a&2){let e=u(2);o(15),_("ngForOf",e.activeOrders)}}function ue(a,r){a&1&&(n(0,"div",68),i(1," No order history found. "),t())}function _e(a,r){if(a&1){let e=C();n(0,"tr")(1,"td"),i(2),t(),n(3,"td"),i(4),t(),n(5,"td"),i(6),t(),n(7,"td"),i(8),t(),n(9,"td"),i(10),t(),n(11,"td")(12,"button",77),O("click",function(){let m=x(e).$implicit,c=u(3);return y(c.viewOrderDetails(m))}),b(13,"i",78),i(14," View Details "),t()()()}if(a&2){let e=r.$implicit,s=u(3);o(2),h(e.id),o(2),h((e.restaurant==null?null:e.restaurant.name)||"N/A"),o(2),h(s.formatDate(e.orderDate)),o(2),h(s.formatDate(e.closedAt)),o(2),h(e.managerName||"N/A")}}function ge(a,r){if(a&1&&(n(0,"div",57)(1,"table",75)(2,"thead")(3,"tr")(4,"th"),i(5,"Order ID"),t(),n(6,"th"),i(7,"Restaurant"),t(),n(8,"th"),i(9,"Date"),t(),n(10,"th"),i(11,"Closed At"),t(),n(12,"th"),i(13,"Manager"),t(),n(14,"th"),i(15,"Actions"),t()()(),n(16,"tbody"),p(17,_e,15,5,"tr",59),t()()()),a&2){let e=u(2);o(17),_("ngForOf",e.orderHistory)}}function fe(a,r){if(a&1&&(n(0,"div")(1,"div",70)(2,"div",71)(3,"h2",45),i(4,"Active Orders"),t()(),n(5,"div",46),p(6,le,2,0,"div",72)(7,ce,16,1,"div",73),t()(),n(8,"div",52)(9,"div",74)(10,"h2",45),i(11,"Order History"),t()(),n(12,"div",46),p(13,ue,2,0,"div",72)(14,ge,18,1,"div",73),t()()()),a&2){let e=u();o(6),_("ngIf",e.activeOrders.length===0),o(),_("ngIf",e.activeOrders.length>0),o(6),_("ngIf",e.orderHistory.length===0),o(),_("ngIf",e.orderHistory.length>0)}}var W=class a{constructor(r,e,s){this.orderService=r;this.authService=e;this.router=s}activeOrders=[];orderHistory=[];isLoading=!1;errorMessage="";successMessage="";selectedOrder=null;isLoadingDetails=!1;orderToClose=null;isProcessingClose=!1;processingPayment=!1;OrderStatus=j;PaymentStatus=U;Object=Object;ngOnInit(){if(!this.authService.isLoggedIn||!this.authService.isAdmin){this.router.navigate(["/"]);return}this.loadActiveOrders(),this.loadOrderHistory()}loadActiveOrders(){this.isLoading=!0,this.errorMessage="",this.orderService.getActiveOrders().subscribe({next:r=>{this.activeOrders=r.map(e=>E(S({},e),{id:e.id,restaurant:{id:"",name:e.restaurantName||"N/A",description:"",address:"",phoneNumber:"",deliveryFee:e.deliveryFee||0},restaurantId:"",managerId:"",status:e.status,orderDate:e.orderDate,closedAt:e.closedAt,deliveryFee:e.deliveryFee})),console.log("Processed active orders:",this.activeOrders),this.isLoading=!1},error:r=>{this.isLoading=!1,this.errorMessage=r.message||"Failed to load active orders"}})}loadOrderHistory(){this.isLoading=!0,this.errorMessage="",this.orderService.getOrderHistory().subscribe({next:r=>{this.orderHistory=r.map(c=>E(S({},c),{id:c.id,restaurant:{id:"",name:c.restaurantName||"N/A",description:"",address:"",phoneNumber:"",deliveryFee:c.deliveryFee||0},restaurantId:"",managerId:"",managerName:c.managerName||"",status:c.status,orderDate:c.orderDate,closedAt:c.closedAt,deliveryFee:c.deliveryFee})),console.log("Processed order history:",this.orderHistory);let e=this.orderHistory.filter(c=>c.status===2),s=0,m=e.length;if(m===0){this.isLoading=!1;return}e.forEach(c=>{this.orderService.getOrderPaymentStatuses(c.id).subscribe({next:l=>{if(l&&l.userPayments&&Array.isArray(l.userPayments)){let d={};l.userPayments.forEach(v=>{d[v.userId]=v.status===2});let g=this.orderHistory.findIndex(v=>v.id===c.id);g!==-1&&(this.orderHistory[g].userItems||(this.orderHistory[g].userItems={}),l.userPayments.forEach(v=>{let I=v.userId;this.orderHistory[g].userItems[I]?this.orderHistory[g].userItems[I].isPaid=v.status===2:this.orderHistory[g].userItems[I]={userName:v.userName||"Unknown User",items:[],totalAmount:v.amount||0,deliveryFee:0,isPaid:v.status===2}}))}s++,s===m&&(this.isLoading=!1)},error:l=>{console.error(`Error fetching payment statuses for order ${c.id}:`,l),s++,s===m&&(this.isLoading=!1)}})})},error:r=>{this.isLoading=!1,this.errorMessage=r.message||"Failed to load order history"}})}showCloseOrderConfirmation(r){r.restaurantName!==void 0?this.orderToClose={id:r.id,restaurantId:"",managerId:"",status:r.status,orderDate:r.orderDate,closedAt:r.closedAt,restaurant:{id:"",name:r.restaurantName,description:"",address:"",phoneNumber:"",deliveryFee:r.deliveryFee||0}}:this.orderToClose=r}cancelCloseOrder(){this.orderToClose=null}confirmCloseOrder(){if(!this.orderToClose)return;this.isProcessingClose=!0,this.errorMessage="";let r=this.orderToClose.id;this.orderService.closeOrder(this.orderToClose.id).subscribe({next:()=>{this.successMessage="Order closed successfully",this.isProcessingClose=!1;let e=this.orderToClose?.id;this.orderToClose=null,this.loadActiveOrders(),this.loadOrderHistory(),this.selectedOrder&&this.selectedOrder.id===e&&this.viewOrderDetails(this.selectedOrder)},error:e=>{this.isProcessingClose=!1,this.errorMessage=e.message||"Failed to close order"}})}viewOrderDetails(r){if(this.isLoadingDetails=!0,this.errorMessage="",r.restaurantName!==void 0){if(this.selectedOrder=E(S({},r),{id:r.id,restaurantId:"",managerId:"",status:r.status,orderDate:r.orderDate,closedAt:r.closedAt,restaurant:{id:"",name:r.restaurantName,description:"",address:"",phoneNumber:"",deliveryFee:r.deliveryFee||0},deliveryFee:r.deliveryFee}),r.userItems&&Array.isArray(r.userItems)&&r.userItems.length>0){console.log("Processing embedded userItems from order",r.userItems);let e={},s=0,m=r.deliveryFee||0;r.userItems.forEach(l=>{let d=l.userId,g=l.userName||"Unknown User",v=l.price||0,I=l.total||v*l.quantity;s+=I,e[d]||(e[d]={userName:g,items:[],totalAmount:0,deliveryFee:0,isPaid:!1});let P={id:l.id,orderId:r.id,userId:l.userId,menuItemId:l.menuItemId||"",quantity:l.quantity,note:l.note,menuItem:{id:l.menuItemId||"",name:l.menuItemName,description:"",price:l.price,restaurantId:""},user:{id:l.userId,name:l.userName,email:""}};e[d].items.push(P),e[d].totalAmount+=I});let c=Object.keys(e).length;if(c>0&&m>0){let l=r.deliveryFeeShare||m/c;Object.keys(e).forEach(d=>{e[d].deliveryFee=l,e[d].totalAmount+=l}),s+=m}this.selectedOrder.userItems=e,this.selectedOrder.totalAmount=s,this.selectedOrder.deliveryFee=m,r.status===2?this.orderService.getOrderPaymentStatuses(r.id).subscribe({next:l=>{console.log("Payment statuses response:",l),l&&l.userPayments&&Array.isArray(l.userPayments)&&l.userPayments.forEach(d=>{d.userId&&e[d.userId]&&(e[d.userId].isPaid=d.status===2)}),this.isLoadingDetails=!1},error:l=>{console.error("Error fetching payment statuses:",l),this.isLoadingDetails=!1}}):this.isLoadingDetails=!1;return}}else this.selectedOrder=S({},r);this.orderService.getAllOrderItems(r.id).subscribe({next:e=>{if(e.items&&Array.isArray(e.items)){console.log("Received new API response format",e),e.restaurantName&&(this.selectedOrder.restaurant?(this.selectedOrder.restaurant.name=e.restaurantName,this.selectedOrder.restaurant.deliveryFee=e.deliveryFee||0):this.selectedOrder.restaurant={id:"",name:e.restaurantName,description:"",address:"",phoneNumber:"",deliveryFee:e.deliveryFee||0});let s={},m=0,c=e.deliveryFee||0;e.items.forEach(d=>{let g=d.userId,v=d.userName||"Unknown User",I=d.price||0,P=d.itemTotal||I*d.quantity;m+=P,s[g]||(s[g]={userName:v,items:[],totalAmount:0,deliveryFee:0,isPaid:!1});let R={id:d.id,orderId:e.orderId||r.id,userId:d.userId,menuItemId:d.menuItemId,quantity:d.quantity,note:d.note,menuItem:{id:d.menuItemId,name:d.menuItemName,description:d.menuItemDescription,price:d.price,restaurantId:""},user:{id:d.userId,name:d.userName,email:""}};s[g].items.push(R),s[g].totalAmount+=P});let l=Object.keys(s).length;if(l>0&&c>0){let d=c/l;Object.keys(s).forEach(g=>{s[g].deliveryFee=d,s[g].totalAmount+=d}),m+=c}this.selectedOrder.userItems=s,this.selectedOrder.totalAmount=m,this.selectedOrder.deliveryFee=c,r.status===2?this.orderService.getOrderPaymentStatuses(r.id).subscribe({next:d=>{console.log("Payment statuses response:",d),d&&d.userPayments&&Array.isArray(d.userPayments)&&d.userPayments.forEach(g=>{g.userId&&s[g.userId]&&(s[g.userId].isPaid=g.status===2)}),this.isLoadingDetails=!1},error:d=>{console.error("Error fetching payment statuses:",d),this.isLoadingDetails=!1}}):this.isLoadingDetails=!1}else{let s=e,m={},c=0;s.forEach(l=>{let d=l.userId,g=l.user?.name||"Unknown User",I=(l.menuItem?.price||0)*l.quantity;c+=I,m[d]||(m[d]={userName:g,items:[],totalAmount:0,deliveryFee:0,isPaid:!1}),m[d].items.push(l),m[d].totalAmount+=I}),this.selectedOrder.userItems=m,this.selectedOrder.totalAmount=c,r.status===2?this.orderService.getOrderPaymentStatuses(r.id).subscribe({next:l=>{console.log("Payment statuses response:",l),l&&l.userPayments&&Array.isArray(l.userPayments)&&l.userPayments.forEach(d=>{d.userId&&m[d.userId]&&(m[d.userId].isPaid=d.status===2)}),this.isLoadingDetails=!1},error:l=>{console.error("Error fetching payment statuses:",l),this.isLoadingDetails=!1}}):this.isLoadingDetails=!1}},error:e=>{this.isLoadingDetails=!1,this.errorMessage=e.message||"Failed to load order details"}})}updatePaymentStatus(r,e,s){this.processingPayment=!0,this.errorMessage="",console.log(`Updating payment status: orderId=${r}, userId=${e}, status=${s}`),this.orderService.updatePaymentStatus(r,e,s).subscribe({next:m=>{console.log("Payment status update response:",m),this.successMessage="Payment status updated successfully",this.orderService.getOrderPaymentStatuses(r).subscribe({next:c=>{console.log("Updated payment statuses:",c),c&&c.userPayments&&Array.isArray(c.userPayments)&&this.selectedOrder&&this.selectedOrder.userItems&&c.userPayments.forEach(d=>{d.userId&&this.selectedOrder.userItems[d.userId]&&(this.selectedOrder.userItems[d.userId].isPaid=d.status===2)});let l=this.orderHistory.findIndex(d=>d.id===r);l!==-1&&(this.orderHistory[l].userItems||(this.orderHistory[l].userItems={}),c&&c.userPayments&&Array.isArray(c.userPayments)&&c.userPayments.forEach(d=>{let g=d.userId;this.orderHistory[l].userItems[g]?this.orderHistory[l].userItems[g].isPaid=d.status===2:this.orderHistory[l].userItems[g]={userName:d.userName||"Unknown User",items:[],totalAmount:d.amount||0,deliveryFee:0,isPaid:d.status===2}})),this.processingPayment=!1},error:c=>{console.error("Error fetching updated payment statuses:",c),this.processingPayment=!1}})},error:m=>{console.error("Error updating payment status:",m),this.processingPayment=!1,this.errorMessage=m.message||"Failed to update payment status"}})}clearSelectedOrder(){this.selectedOrder=null}getOrderStatusName(r){switch(r){case 1:return"Open";case 2:return"Closed";default:return"Unknown"}}getOrderStatusClass(r){switch(r){case 1:return"bg-success";case 2:return"bg-secondary";default:return"bg-secondary"}}formatDate(r){return r?new Date(r).toLocaleString():"N/A"}static \u0275fac=function(e){return new(e||a)(M(q),M(H),M(V))};static \u0275cmp=w({type:a,selectors:[["app-order-management"]],decls:14,vars:6,consts:[["noItems",""],[1,"container","py-4"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],["class","alert alert-danger alert-dismissible fade show","role","alert",4,"ngIf"],["class","alert alert-success alert-dismissible fade show","role","alert",4,"ngIf"],["class","d-flex justify-content-center my-5",4,"ngIf"],["class","confirmation-modal-overlay",4,"ngIf"],["class","order-details-overlay",4,"ngIf"],[4,"ngIf"],[1,"mt-4"],["routerLink","/admin",1,"btn","btn-secondary"],[1,"fas","fa-arrow-left","me-2"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],["type","button",1,"btn-close",3,"click"],["role","alert",1,"alert","alert-success","alert-dismissible","fade","show"],[1,"d-flex","justify-content-center","my-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"confirmation-modal-overlay"],[1,"confirmation-modal"],[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[1,"alert","alert-warning"],[1,"fas","fa-exclamation-triangle","me-2"],[1,"order-info","mt-3"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-danger",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2","role","status","aria-hidden","true",4,"ngIf"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],[1,"order-details-overlay"],[1,"order-details-modal"],[1,"badge","ms-2",3,"ngClass"],["class","d-flex justify-content-center my-4",4,"ngIf"],["type","button","class","btn btn-danger",3,"click",4,"ngIf"],[1,"d-flex","justify-content-center","my-4"],[1,"order-info","mb-4"],[1,"row"],[1,"col-md-6"],[1,"mb-3"],[4,"ngIf","ngIfElse"],["class","user-order-section mb-4",4,"ngFor","ngForOf"],[1,"card","mt-4"],[1,"card-header"],[1,"mb-0"],[1,"card-body"],[1,"col-md-6","offset-md-6"],[1,"table"],[1,"text-end"],[1,"fw-bold"],[1,"user-order-section","mb-4"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"badge","me-2",3,"ngClass"],["class","btn btn-sm btn-success",3,"disabled","click",4,"ngIf"],["class","btn btn-sm btn-warning",3,"disabled","click",4,"ngIf"],[1,"table-responsive"],[1,"table","table-sm"],[4,"ngFor","ngForOf"],["class","delivery-fee-row",4,"ngIf"],["colspan","3",1,"text-end"],[1,"btn","btn-sm","btn-success",3,"click","disabled"],[1,"fas","fa-check","me-1"],[1,"btn","btn-sm","btn-warning",3,"click","disabled"],[1,"fas","fa-times","me-1"],[1,"delivery-fee-row"],["colspan","3",1,"text-end","fw-bold"],[1,"alert","alert-info"],["type","button",1,"btn","btn-danger",3,"click"],[1,"card","mb-4"],[1,"card-header","bg-success","text-white"],["class","alert alert-info",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"card-header","bg-secondary","text-white"],[1,"table","table-hover"],["role","group",1,"btn-group"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-eye","me-1"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-times-circle","me-1"]],template:function(e,s){e&1&&(n(0,"div",1)(1,"div",2)(2,"h1"),i(3,"Order Management"),t()(),p(4,z,3,1,"div",3)(5,Y,3,1,"div",4)(6,B,4,0,"div",5)(7,G,31,5,"div",6)(8,oe,15,5,"div",7)(9,fe,15,4,"div",8),n(10,"div",9)(11,"a",10),b(12,"i",11),i(13,"Back to Dashboard "),t()()()),e&2&&(o(4),_("ngIf",s.errorMessage),o(),_("ngIf",s.successMessage),o(),_("ngIf",s.isLoading),o(),_("ngIf",s.orderToClose),o(),_("ngIf",s.selectedOrder),o(),_("ngIf",!s.isLoading))},dependencies:[N,k,T,D,$,L],styles:[".table-responsive[_ngcontent-%COMP%]{overflow-x:auto}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:.25rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-right:0}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa}.badge[_ngcontent-%COMP%]{font-size:.85rem;padding:.5rem}@media (max-width: 768px){.btn-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:0;margin-bottom:.25rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-bottom:0}}.order-details-overlay[_ngcontent-%COMP%], .confirmation-modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1050;overflow-y:auto;padding:30px}.order-details-modal[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;width:90%;max-width:900px;max-height:90vh;overflow-y:auto;box-shadow:0 10px 25px #0003;display:flex;flex-direction:column}.confirmation-modal[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;width:90%;max-width:500px;box-shadow:0 10px 25px #0003;display:flex;flex-direction:column;animation:_ngcontent-%COMP%_modalFadeIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalFadeIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem;border-bottom:1px solid #dee2e6}.modal-body[_ngcontent-%COMP%]{padding:1rem;flex:1;overflow-y:auto}.modal-footer[_ngcontent-%COMP%]{padding:1rem;border-top:1px solid #dee2e6;display:flex;justify-content:flex-end;gap:10px}.user-order-section[_ngcontent-%COMP%]{margin-bottom:1.5rem}.card[_ngcontent-%COMP%]{border:none;box-shadow:0 2px 10px #0000001a}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #eee}table[_ngcontent-%COMP%]{width:100%}.table-sm[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table-sm[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.5rem}.badge[_ngcontent-%COMP%]{padding:.5rem .75rem;font-size:.8rem;font-weight:500}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:5px}.alert-warning[_ngcontent-%COMP%]{border-left:4px solid #ffc107}@media (max-width: 768px){.order-details-modal[_ngcontent-%COMP%], .confirmation-modal[_ngcontent-%COMP%]{width:95%;max-height:95vh}.card-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start!important}.card-header[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-top:10px}}.delivery-fee-row[_ngcontent-%COMP%]{background-color:#f8f9fa;font-style:italic}.delivery-fee-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:1px dashed #dee2e6}"]})};export{W as OrderManagementComponent};
