import{c as F}from"./chunk-5ISVOT5D.js";import{a as N,b as v,c as M,d as w,g as T,i as R,j as V,q as L,s as O}from"./chunk-L4PQJYKC.js";import{$ as m,F as x,G as b,P as o,R as g,S as C,Sa as I,W as p,Ya as P,fb as E,ga as n,ha as t,ia as c,la as y,ma as S,na as u,sa as r,ua as f}from"./chunk-WQE5TX3G.js";import{a as h}from"./chunk-AIZVJUQQ.js";function U(e,a){if(e&1&&(n(0,"div",6),r(1),t()),e&2){let i=u();o(),f(" ",i.errorMessage," ")}}function D(e,a){if(e&1&&(n(0,"div",7),r(1),t()),e&2){let i=u();o(),f(" ",i.successMessage," ")}}function q(e,a){e&1&&(n(0,"div",8)(1,"div",9)(2,"span",10),r(3,"Loading..."),t()()())}function G(e,a){e&1&&(n(0,"div",31),r(1," Name is required "),t())}function A(e,a){e&1&&(n(0,"span"),r(1,"Email is required"),t())}function B(e,a){e&1&&(n(0,"span"),r(1,"Please enter a valid email address"),t())}function j(e,a){if(e&1&&(n(0,"div",31),p(1,A,2,0,"span",28)(2,B,2,0,"span",28),t()),e&2){let i,l,d=u(2);o(),m("ngIf",(i=d.profileForm.get("email"))==null||i.errors==null?null:i.errors.required),o(),m("ngIf",(l=d.profileForm.get("email"))==null||l.errors==null?null:l.errors.email)}}function k(e,a){e&1&&(n(0,"div",31),r(1," Please enter a valid phone number "),t())}function $(e,a){e&1&&(n(0,"span"),r(1,"Save Changes"),t())}function z(e,a){e&1&&(n(0,"span"),c(1,"span",32),r(2," Saving... "),t())}function H(e,a){if(e&1){let i=y();n(0,"div",11)(1,"div",12)(2,"div",13)(3,"div",14)(4,"h5",15),r(5,"Profile Information"),t()(),n(6,"div",16)(7,"form",17),S("ngSubmit",function(){x(i);let d=u();return b(d.onSubmit())}),n(8,"div",18)(9,"label",19),r(10,"Name"),t(),c(11,"input",20),p(12,G,2,0,"div",21),t(),n(13,"div",18)(14,"label",22),r(15,"Email"),t(),c(16,"input",23),p(17,j,3,2,"div",21),t(),n(18,"div",18)(19,"label",24),r(20,"Phone Number"),t(),c(21,"input",25),p(22,k,2,0,"div",21),t(),n(23,"div",26)(24,"button",27),p(25,$,2,0,"span",28)(26,z,3,0,"span",28),t(),n(27,"button",29),S("click",function(){x(i);let d=u();return b(d.changePassword())}),r(28," Change Password "),t()()()()()(),n(29,"div",30)(30,"div",13)(31,"div",14)(32,"h5",15),r(33,"Account Information"),t()(),n(34,"div",16)(35,"p")(36,"strong"),r(37,"User ID:"),t(),r(38),t(),n(39,"p")(40,"strong"),r(41,"Role:"),t(),r(42),t()()()()()}if(e&2){let i,l,d,s=u();o(7),m("formGroup",s.profileForm),o(5),m("ngIf",((i=s.profileForm.get("name"))==null?null:i.invalid)&&((i=s.profileForm.get("name"))==null?null:i.touched)),o(5),m("ngIf",((l=s.profileForm.get("email"))==null?null:l.invalid)&&((l=s.profileForm.get("email"))==null?null:l.touched)),o(5),m("ngIf",((d=s.profileForm.get("phoneNumber"))==null?null:d.invalid)&&((d=s.profileForm.get("phoneNumber"))==null?null:d.touched)),o(2),m("disabled",s.profileForm.invalid||s.isSaving),o(),m("ngIf",!s.isSaving),o(),m("ngIf",s.isSaving),o(12),f(" ",s.user.id,""),o(4),f(" ",s.user.role,"")}}var _=class e{constructor(a,i,l){this.formBuilder=a;this.authService=i;this.router=l;this.profileForm=this.formBuilder.group({name:["",v.required],email:["",[v.required,v.email]],phoneNumber:["",v.pattern(/^\+?[0-9]{10,15}$/)]})}profileForm;user=null;isLoading=!1;isSaving=!1;errorMessage="";successMessage="";ngOnInit(){if(this.isLoading=!0,!this.authService.isLoggedIn){this.router.navigate(["/auth/login"],{queryParams:{returnUrl:"/profile"}});return}this.user=this.authService.currentUser,this.user&&this.profileForm.patchValue({name:this.user.name,email:this.user.email,phoneNumber:this.user.phoneNumber||""}),this.isLoading=!1}onSubmit(){if(this.profileForm.invalid)return;this.isSaving=!0,this.errorMessage="",this.successMessage="";let a=h(h({},this.user),this.profileForm.value);this.authService.updateProfile(a).subscribe({next:i=>{this.user=i,this.isSaving=!1,this.successMessage="Profile updated successfully!",this.authService.storeUserData(i)},error:i=>{this.isSaving=!1,this.errorMessage=i.message||"Failed to update profile. Please try again."}})}changePassword(){this.router.navigate(["/profile/change-password"])}static \u0275fac=function(i){return new(i||e)(g(L),g(F),g(E))};static \u0275cmp=C({type:e,selectors:[["app-profile"]],decls:7,vars:4,consts:[[1,"container","py-4"],[1,"mb-4"],["class","alert alert-danger",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["class","text-center my-5",4,"ngIf"],["class","row",4,"ngIf"],[1,"alert","alert-danger"],[1,"alert","alert-success"],[1,"text-center","my-5"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"row"],[1,"col-md-8"],[1,"card","shadow-sm"],[1,"card-header","bg-light"],[1,"mb-0"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","id","name","formControlName","name",1,"form-control"],["class","text-danger small",4,"ngIf"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email",1,"form-control"],["for","phoneNumber",1,"form-label"],["type","tel","id","phoneNumber","formControlName","phoneNumber",1,"form-control"],[1,"d-flex","justify-content-between"],["type","submit",1,"btn","btn-primary",3,"disabled"],[4,"ngIf"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"col-md-4"],[1,"text-danger","small"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"]],template:function(i,l){i&1&&(n(0,"div",0)(1,"h1",1),r(2,"My Profile"),t(),p(3,U,2,1,"div",2)(4,D,2,1,"div",3)(5,q,4,0,"div",4)(6,H,43,9,"div",5),t()),i&2&&(o(3),m("ngIf",l.errorMessage),o(),m("ngIf",l.successMessage),o(),m("ngIf",l.isLoading),o(),m("ngIf",!l.isLoading&&l.user))},dependencies:[P,I,O,T,N,M,w,R,V],styles:[".card[_ngcontent-%COMP%]{border:none;box-shadow:0 .125rem .25rem #00000013}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid rgba(0,0,0,.05)}.form-control[_ngcontent-%COMP%]:focus{border-color:var(--primary-color);box-shadow:0 0 0 .25rem #ff6b6b40}"]})};var le=[{path:"",component:_}];export{le as PROFILE_ROUTES};
